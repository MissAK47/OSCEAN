# ã€æ¨¡å—æ£€æŸ¥æ–¹æ¡ˆ02ã€‘æ•°æ®è®¿é—®æœåŠ¡ç»Ÿä¸€é‡æ„æ–¹æ¡ˆ - å®Œæ•´é‡æ„æŒ‡å¯¼

## ğŸ“‹ 1. å…³é”®å†²çªä¿®æ­£ä¸æ¶æ„ç»Ÿä¸€

### 1.1 Critical Issues Summary (åŸºäºè·¨æ¨¡å—å†²çªåˆ†æ)
ç»è¿‡ä¸Commoné€šç”¨åº“åŠå…¶ä»–4ä¸ªæ¨¡å—é‡æ„æ–¹æ¡ˆçš„å…¨é¢å†²çªåˆ†æï¼Œæ•°æ®è®¿é—®æœåŠ¡å­˜åœ¨ä»¥ä¸‹**é‡å¤§æ¶æ„é—®é¢˜**ï¼š

#### ğŸ”´ **Açº§é—®é¢˜ï¼šåŠŸèƒ½é‡å¤ä¸¥é‡**
- **ç¼“å­˜é‡å¤**: ç‹¬ç«‹å®ç°`ReaderCache`ã€`DataChunkCache`ï¼Œè¿åCommonç»Ÿä¸€ç¼“å­˜åŸåˆ™
- **çº¿ç¨‹æ± é‡å¤**: å·¥å‚å‡½æ•°æ¥å—ç‹¬ç«‹çº¿ç¨‹æ± å‚æ•°ï¼Œè¿å`UnifiedThreadPoolManager`ä½¿ç”¨è¦æ±‚
- **æ€§èƒ½ç›‘æ§é‡å¤**: ä½¿ç”¨`NetCDFPerformanceManager`ï¼Œåº”ç»Ÿä¸€ä½¿ç”¨`UnifiedPerformanceMonitor`
- **ä¿®æ­£**: å¼ºåˆ¶åˆ é™¤æ‰€æœ‰é‡å¤å®ç°ï¼Œä½¿ç”¨Commonç»Ÿä¸€åŸºç¡€è®¾æ–½

#### ğŸ”´ **Bçº§é—®é¢˜ï¼šæ—¶é—´æ¶æ„èŒè´£ç¼ºå¤±**
- **é—®é¢˜**: æ•°æ®è®¿é—®æœåŠ¡åº”è¯¥**å®ç°**æ ¼å¼ä¸“ç”¨æ—¶é—´æå–å™¨ï¼Œä½†å½“å‰ç¼ºå¤±
- **èŒè´£å®šä½**: æŒ‰ç…§ä¸‰å±‚æ—¶é—´æ¶æ„ï¼Œæ•°æ®è®¿é—®å±‚è´Ÿè´£æ ¼å¼ä¸“ç”¨è§£æå®ç°
- **ä¿®æ­£**: å®ç°`NetCDFTimeExtractor`ã€`GDALTimeExtractor`å¹¶æ³¨å†Œåˆ°Commonå·¥å‚

#### ğŸ”´ **Cçº§é—®é¢˜ï¼šæµå¼å¤„ç†å®Œå…¨ç¼ºå¤±**
- **ç¼ºå¤±**: å®Œå…¨ç¼ºå°‘å¤§æ–‡ä»¶æµå¼è¯»å–æ”¯æŒï¼Œè¿åè®¾è®¡æ–‡æ¡£"é¿å…ä¸€æ¬¡æ€§åŠ è½½"è¦æ±‚
- **å½±å“**: æ— æ³•å¤„ç†GBçº§æµ·æ´‹æ•°æ®æ–‡ä»¶ï¼Œå†…å­˜æº¢å‡ºé£é™©
- **ä¿®æ­£**: åŸºäºCommonæµå¼æ¡†æ¶å®ç°æ•°æ®è®¿é—®å±‚çš„æµå¼è¯»å–å™¨

#### ğŸŸ¡ **Dçº§é—®é¢˜ï¼šå¼‚æ­¥æ¨¡å¼éœ€å¼ºåŒ–**
- **çŠ¶æ€**: å·²ä½¿ç”¨`boost::future`ï¼Œä½†ç¼ºä¹ä¸Commonç»Ÿä¸€å¼‚æ­¥æ¡†æ¶çš„é›†æˆ
- **é—®é¢˜**: é”™è¯¯å¤„ç†ã€å¼‚æ­¥ç»„åˆå·¥å…·æœªä½¿ç”¨Commonæä¾›çš„ç»Ÿä¸€æ–¹æ¡ˆ
- **ä¿®æ­£**: å¼ºåˆ¶ä½¿ç”¨Commonå±‚çš„`OSCEAN_FUTURE(T)`å®å’Œç»Ÿä¸€å¼‚æ­¥å·¥å…·

### 1.2 é‡æ„åçš„æ•°æ®è®¿é—®æœåŠ¡æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             é‡æ„åçš„æ•°æ®è®¿é—®æœåŠ¡æ¶æ„ (ä¿®æ­£ç‰ˆ)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“± æ•°æ®è®¿é—®æœåŠ¡æ¥å£å±‚ (å…¨éƒ¨ä½¿ç”¨OSCEAN_FUTURE)               â”‚
â”‚  â”œâ”€â”€ IRawDataAccessService     (ç»Ÿä¸€å¼‚æ­¥æ¥å£)                â”‚
â”‚  â”œâ”€â”€ IStreamingDataAccess      (ğŸ†• æµå¼æ•°æ®è®¿é—®)             â”‚
â”‚  â””â”€â”€ ITimeMetadataProvider     (ğŸ†• æ—¶é—´å…ƒæ•°æ®æä¾›)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”§ æ ¸å¿ƒå®ç°å±‚ (ä¸¥æ ¼ä¾èµ–Common)                              â”‚
â”‚  â”œâ”€â”€ RawDataAccessServiceImpl  (ç§»é™¤é‡å¤åŸºç¡€è®¾æ–½)            â”‚
â”‚  â”œâ”€â”€ StreamingDataAccessImpl   (ğŸ†• åŸºäºCommonæµå¼æ¡†æ¶)       â”‚
â”‚  â”œâ”€â”€ NetCDFTimeExtractor       (ğŸ†• æ ¼å¼ä¸“ç”¨æ—¶é—´è§£æ)         â”‚
â”‚  â”œâ”€â”€ GDALTimeExtractor         (ğŸ†• æ ¼å¼ä¸“ç”¨æ—¶é—´è§£æ)         â”‚
â”‚  â””â”€â”€ HDF5TimeExtractor         (ğŸ†• æ ¼å¼ä¸“ç”¨æ—¶é—´è§£æ)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ æ ¼å¼è¯»å–å™¨å±‚ (å¢å¼ºæµå¼æ”¯æŒ)                               â”‚
â”‚  â”œâ”€â”€ NetCDFReader             (ä½¿ç”¨Commonç»Ÿä¸€æ€§èƒ½ç›‘æ§)       â”‚
â”‚  â”œâ”€â”€ GDALReader               (ä½¿ç”¨Commonç»Ÿä¸€çº¿ç¨‹æ± )         â”‚
â”‚  â”œâ”€â”€ StreamingNetCDFReader    (ğŸ†• æµå¼NetCDFè¯»å–)           â”‚
â”‚  â””â”€â”€ StreamingGDALReader      (ğŸ†• æµå¼GDALè¯»å–)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â¬‡ï¸  ä¸¥æ ¼ä¾èµ– Commoné€šç”¨åº“ (ç»ä¸é‡å¤å®ç°)                     â”‚
â”‚  â”œâ”€â”€ OSCEAN_FUTURE()          (å¼ºåˆ¶å¼‚æ­¥ç±»å‹)                â”‚
â”‚  â”œâ”€â”€ UnifiedPerformanceMonitor (å¼ºåˆ¶æ€§èƒ½ç›‘æ§)               â”‚
â”‚  â”œâ”€â”€ UnifiedThreadPoolManager  (å¼ºåˆ¶çº¿ç¨‹æ± ç®¡ç†)             â”‚
â”‚  â”œâ”€â”€ UnifiedMemoryManager      (å¼ºåˆ¶å†…å­˜ç®¡ç†)               â”‚
â”‚  â”œâ”€â”€ UnifiedStreamingFramework (å¼ºåˆ¶æµå¼å¤„ç†)               â”‚
â”‚  â””â”€â”€ TimeExtractorFactory      (æ—¶é—´æå–å™¨å·¥å‚)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ 2. æ ¸å¿ƒä¿®æ­£å®æ–½æ–¹æ¡ˆ

### 2.1 **ä¿®æ­£Aï¼šæ¶ˆé™¤åŠŸèƒ½é‡å¤å®ç°**

#### **åˆ é™¤é‡å¤åŸºç¡€è®¾æ–½çš„ç»Ÿä¸€å®ç°**
```cpp
// æ–‡ä»¶: include/core_services/data_access/unified_data_access_service.h
#pragma once
#include "common_utils/async/unified_async_framework.h"
#include "common_utils/infrastructure/unified_cache_manager.h"
#include "common_utils/infrastructure/unified_thread_pool_manager.h"
#include "common_utils/infrastructure/unified_performance_monitor.h"

namespace oscean::core_services::data_access {

using namespace oscean::common_utils::async;
using namespace oscean::common_utils::infrastructure;

/**
 * @brief ç»Ÿä¸€æ•°æ®è®¿é—®æœåŠ¡å®ç° - ç§»é™¤æ‰€æœ‰é‡å¤åŸºç¡€è®¾æ–½
 */
class UnifiedRawDataAccessServiceImpl : public IRawDataAccessService {
public:
    // ğŸ”„ ä¿®æ­£åçš„æ„é€ å‡½æ•° - ä»…æ¥å—ä¸šåŠ¡ä¾èµ–
    explicit UnifiedRawDataAccessServiceImpl(
        std::shared_ptr<ICrsService> crsService,
        std::shared_ptr<ICrsServiceGdalExtended> crsServiceExtended,
        std::shared_ptr<ReaderFactory> readerFactory
        // âŒ ç§»é™¤: threadPool å‚æ•° (ä½¿ç”¨Commonç»Ÿä¸€çº¿ç¨‹æ± )
        // âŒ ç§»é™¤: readerCache å‚æ•° (ä½¿ç”¨Commonç»Ÿä¸€ç¼“å­˜)
        // âŒ ç§»é™¤: dataChunkCache å‚æ•° (ä½¿ç”¨Commonç»Ÿä¸€ç¼“å­˜)
    );
    
    // æ•°æ®è¯»å–æ¥å£ (ä½¿ç”¨Commonå¼‚æ­¥æ¡†æ¶)
    OSCEAN_FUTURE(GridData) readGridVariableSubsetAsync(
        const std::string& filePath,
        const std::string& variableName,
        const std::vector<DimensionBounds>& bounds
    ) override;
    
    OSCEAN_FUTURE(std::vector<Feature>) readFeaturesAsync(
        const std::string& filePath,
        const SpatialFilter& spatialFilter,
        const std::optional<std::string>& crs
    ) override;

private:
    // ä¸šåŠ¡ä¾èµ–
    std::shared_ptr<ICrsService> crsService_;
    std::shared_ptr<ICrsServiceGdalExtended> crsServiceExtended_;
    std::shared_ptr<ReaderFactory> readerFactory_;
    
    // âœ… ä½¿ç”¨Commonç»Ÿä¸€åŸºç¡€è®¾æ–½ (å¼•ç”¨æ–¹å¼ï¼Œç¡®ä¿å”¯ä¸€æ€§)
    UnifiedCacheManager& cacheManager_;
    UnifiedThreadPoolManager& threadPoolManager_;
    UnifiedPerformanceMonitor& perfMonitor_;
    
    // âŒ åˆ é™¤çš„é‡å¤å®ç°
    // std::shared_ptr<data_access::cache::ReaderCache> m_readerCache;
    // std::shared_ptr<data_access::cache::DataChunkCache> m_dataCache;
    // std::shared_ptr<boost::asio::thread_pool> m_threadPool;
    // std::shared_ptr<NetCDFPerformanceManager> m_netcdfPerfManager;
};
}
```

### 2.2 **ä¿®æ­£Bï¼šå®ç°æ ¼å¼ä¸“ç”¨æ—¶é—´æå–å™¨**

#### **NetCDFæ—¶é—´æå–å™¨å®ç°**
```cpp
// æ–‡ä»¶: include/core_services/data_access/time/netcdf_time_extractor.h
#pragma once
#include "common_utils/time/time_types.h"
#include "common_utils/async/unified_async_framework.h"

namespace oscean::core_services::data_access::time {

using namespace oscean::common_utils::time;
using namespace oscean::common_utils::async;

/**
 * @brief NetCDFæ—¶é—´æå–å™¨ - å®ç°Commonå±‚ITimeMetadataExtractoræ¥å£
 */
class NetCDFTimeExtractor : public ITimeMetadataExtractor {
public:
    explicit NetCDFTimeExtractor(const std::string& filePath);
    
    // ITimeMetadataExtractoræ¥å£å®ç°
    OSCEAN_FUTURE(TimeRange) extractTimeRangeAsync() const override;
    OSCEAN_FUTURE(TimeResolutionInfo) calculateTimeResolutionAsync() const override;
    OSCEAN_FUTURE(std::vector<CalendarTime>) extractAllTimePointsAsync() const override;
    
    bool hasValidTimeDimension() const override;
    std::string getTimeDimensionName() const override;
    std::string getFormatType() const override { return "NetCDF"; }
    std::vector<std::string> getSupportedCalendars() const override;
    
    OSCEAN_FUTURE(void) extractTimePointsStreaming(
        std::function<void(const std::vector<CalendarTime>&)> callback,
        size_t batchSize = 1000
    ) const override;
    
    OSCEAN_FUTURE(TimeResolutionInfo) analyzeTimeQualityAsync() const override;

private:
    std::string filePath_;
    // ä½¿ç”¨Commonç»Ÿä¸€æ€§èƒ½ç›‘æ§
    UnifiedPerformanceMonitor& perfMonitor_;
};

/**
 * @brief æ—¶é—´æå–å™¨æ³¨å†Œç®¡ç†å™¨
 */
class TimeExtractorRegistry {
public:
    // å‘Commonå·¥å‚æ³¨å†Œæ‰€æœ‰æ—¶é—´æå–å™¨
    static void registerAllExtractors();
};

} // namespace oscean::core_services::data_access::time
```

### 2.3 **ä¿®æ­£Cï¼šå®ç°æµå¼æ•°æ®è®¿é—®**

#### **åŸºäºCommonæµå¼æ¡†æ¶çš„å®ç°**
```cpp
// æ–‡ä»¶: include/core_services/data_access/streaming/streaming_data_access.h
#pragma once
#include "common_utils/streaming/unified_streaming_framework.h"

namespace oscean::core_services::data_access::streaming {

using namespace oscean::common_utils::streaming;
using namespace oscean::common_utils::async;

/**
 * @brief æµå¼æ•°æ®è®¿é—®æ¥å£
 */
class IStreamingDataAccess {
public:
    virtual ~IStreamingDataAccess() = default;
    
    // åˆ›å»ºç½‘æ ¼æ•°æ®æµ
    virtual OSCEAN_FUTURE(std::shared_ptr<IDataStream<GridData>>) createGridStreamAsync(
        const std::string& filePath,
        const std::string& variableName,
        const StreamingConfig& config = StreamingConfig{}
    ) = 0;
    
    // æ‰¹é‡æ–‡ä»¶æµå¼å¤„ç†
    virtual OSCEAN_FUTURE(void) processFilesStreamingAsync(
        const std::vector<std::string>& filePaths,
        std::function<void(const DataChunk<GridData>&)> processor,
        const StreamingConfig& config = StreamingConfig{}
    ) = 0;
};

/**
 * @brief æµå¼NetCDFè¯»å–å™¨ - åŸºäºCommonæµå¼æ¡†æ¶
 */
class StreamingNetCDFReader : public IDataStream<GridData> {
public:
    StreamingNetCDFReader(
        const std::string& filePath,
        const std::string& variableName,
        const StreamingConfig& config
    );
    
    // IDataStreamæ¥å£å®ç°
    void setChunkCallback(ChunkCallback callback) override;
    void setErrorCallback(ErrorCallback callback) override;
    void setProgressCallback(ProgressCallback callback) override;
    
    OSCEAN_FUTURE(void) startStreamingAsync() override;
    void pause() override;
    void resume() override;
    void cancel() override;
    
    bool isActive() const override;
    bool isPaused() const override;
    size_t getBytesProcessed() const override;
    size_t getTotalSize() const override;
    double getProgress() const override;

private:
    std::string filePath_;
    std::string variableName_;
    StreamingConfig config_;
    
    // ä½¿ç”¨Commonç»Ÿä¸€ç›‘æ§
    UnifiedPerformanceMonitor& perfMonitor_;
    std::shared_ptr<MemoryPressureMonitor> pressureMonitor_;
};

} // namespace oscean::core_services::data_access::streaming
```

## ğŸ—ï¸ 3. å®Œæ•´å®æ–½è®¡åˆ’

### 3.1 å®æ–½é˜¶æ®µ
```mermaid
gantt
    title æ•°æ®è®¿é—®æœåŠ¡ç»Ÿä¸€é‡æ„å®æ–½è®¡åˆ’
    dateFormat  YYYY-MM-DD
    section é˜¶æ®µä¸€ï¼šåŸºç¡€è®¾æ–½ç»Ÿä¸€
    åˆ é™¤é‡å¤å®ç°        :crit, a1, 2024-01-01, 1d
    é›†æˆCommonç»„ä»¶      :crit, a2, after a1, 1d
    section é˜¶æ®µäºŒï¼šæ—¶é—´æå–å™¨å®ç°
    NetCDFæ—¶é—´æå–å™¨    :crit, t1, after a2, 1d
    GDALæ—¶é—´æå–å™¨      :crit, t2, after t1, 1d
    æ³¨å†Œåˆ°Commonå·¥å‚    :crit, t3, after t2, 1d
    section é˜¶æ®µä¸‰ï¼šæµå¼å¤„ç†
    æµå¼æ¥å£è®¾è®¡        :crit, s1, after t3, 1d
    NetCDFæµå¼è¯»å–      :crit, s2, after s1, 1d
    GDALæµå¼è¯»å–        :crit, s3, after s2, 1d
    section é˜¶æ®µå››ï¼šéªŒè¯æµ‹è¯•
    å•å…ƒæµ‹è¯•            :test1, after s3, 1d
    é›†æˆæµ‹è¯•            :test2, after test1, 1d
    æ€§èƒ½æµ‹è¯•            :test3, after test2, 1d
```

### 3.2 å…³é”®å®æ–½é‡Œç¨‹ç¢‘

#### **é‡Œç¨‹ç¢‘1ï¼šåŸºç¡€è®¾æ–½ç»Ÿä¸€å®Œæˆ** âœ…
**éªŒè¯æ ‡å‡†**:
- [ ] åˆ é™¤æ‰€æœ‰`data_access::cache::`å‘½åç©ºé—´å®ç°
- [ ] å·¥å‚å‡½æ•°ç§»é™¤`threadPool`ã€`readerCache`ã€`dataChunkCache`å‚æ•°
- [ ] æ‰€æœ‰æ€§èƒ½ç›‘æ§ä½¿ç”¨`UnifiedPerformanceMonitor`
- [ ] å†…å­˜ç®¡ç†ä½¿ç”¨`UnifiedMemoryManager`

#### **é‡Œç¨‹ç¢‘2ï¼šæ—¶é—´æå–å™¨å®ç°å®Œæˆ** âœ…
**éªŒè¯æ ‡å‡†**:
- [ ] `NetCDFTimeExtractor`å®Œæ•´å®ç°CFæ—¶é—´æ ‡å‡†è§£æ
- [ ] `GDALTimeExtractor`å®ç°å¤šç§æ—¶é—´æå–ç­–ç•¥
- [ ] æ—¶é—´æå–å™¨æˆåŠŸæ³¨å†Œåˆ°Commonå·¥å‚
- [ ] æ”¯æŒæµå¼æ—¶é—´ç‚¹æå–(å¤§æ–‡ä»¶å‹å¥½)

#### **é‡Œç¨‹ç¢‘3ï¼šæµå¼å¤„ç†æ¡†æ¶å®Œæˆ** âœ…
**éªŒè¯æ ‡å‡†**:
- [ ] 2GB NetCDFæ–‡ä»¶æµå¼å¤„ç†å†…å­˜ä½¿ç”¨<256MB
- [ ] æ”¯æŒç½‘æ ¼æ•°æ®å’Œè¦ç´ æ•°æ®çš„æµå¼è¯»å–
- [ ] å†…å­˜å‹åŠ›è‡ªåŠ¨ç›‘æ§å’Œè‡ªé€‚åº”è°ƒæ•´
- [ ] æµå¼å¤„ç†ç®¡é“æ”¯æŒå¹¶è¡Œå’ŒèƒŒå‹æ§åˆ¶

## ğŸ“‹ 4. éªŒè¯ä¸æµ‹è¯•æ¡†æ¶

### 4.1 åŸºç¡€è®¾æ–½ç»Ÿä¸€éªŒè¯
```bash
#!/bin/bash
# æ–‡ä»¶: scripts/validate_infrastructure_unification.sh

echo "ğŸ” éªŒè¯åŸºç¡€è®¾æ–½ç»Ÿä¸€..."

# æ£€æŸ¥é‡å¤ç¼“å­˜å®ç°åˆ é™¤
if find core_services_impl/data_access_service -name "*.h" -o -name "*.cpp" | \
   xargs grep -l "data_access::cache::" 2>/dev/null; then
    echo "âŒ å‘ç°é‡å¤ç¼“å­˜å®ç°æœªåˆ é™¤"
    exit 1
fi

# æ£€æŸ¥Commonç»Ÿä¸€ç»„ä»¶ä½¿ç”¨
required_components=("UnifiedCacheManager" "UnifiedThreadPoolManager" "UnifiedPerformanceMonitor")
for component in "${required_components[@]}"; do
    if ! find core_services_impl/data_access_service -name "*.cpp" | \
       xargs grep -q "$component"; then
        echo "âŒ æœªä½¿ç”¨Commonç»„ä»¶: $component"
        exit 1
    fi
done

echo "âœ… åŸºç¡€è®¾æ–½ç»Ÿä¸€éªŒè¯é€šè¿‡"
```

### 4.2 æ—¶é—´æå–å™¨åŠŸèƒ½éªŒè¯
```bash
#!/bin/bash
# æ–‡ä»¶: scripts/validate_time_extractors.sh

echo "ğŸ” éªŒè¯æ—¶é—´æå–å™¨å®ç°..."

# æ£€æŸ¥æ—¶é—´æå–å™¨æ–‡ä»¶å­˜åœ¨
required_files=(
    "include/core_services/data_access/time/netcdf_time_extractor.h"
    "include/core_services/data_access/time/gdal_time_extractor.h"
    "src/impl/time/time_extractor_registry.cpp"
)

for file in "${required_files[@]}"; do
    if [ ! -f "core_services_impl/data_access_service/$file" ]; then
        echo "âŒ æ—¶é—´æå–å™¨æ–‡ä»¶ç¼ºå¤±: $file"
        exit 1
    fi
done

# è¿è¡Œæ—¶é—´æå–å™¨åŠŸèƒ½æµ‹è¯•
./bin/time_extractor_test || {
    echo "âŒ æ—¶é—´æå–å™¨åŠŸèƒ½æµ‹è¯•å¤±è´¥"
    exit 1
}

echo "âœ… æ—¶é—´æå–å™¨éªŒè¯é€šè¿‡"
```

### 4.3 æµå¼å¤„ç†æ€§èƒ½éªŒè¯
```bash
#!/bin/bash
# æ–‡ä»¶: scripts/validate_streaming_performance.sh

echo "ğŸ” éªŒè¯æµå¼å¤„ç†æ€§èƒ½..."

# åˆ›å»º2GBæµ‹è¯•æ–‡ä»¶
test_file="test_data/large_test_2gb.nc"
if [ ! -f "$test_file" ]; then
    echo "åˆ›å»º2GBæµ‹è¯•NetCDFæ–‡ä»¶..."
    # ç”Ÿæˆæµ‹è¯•æ–‡ä»¶é€»è¾‘
fi

# è¿è¡Œæµå¼å¤„ç†å†…å­˜æµ‹è¯•
./bin/streaming_memory_test "$test_file" || {
    echo "âŒ æµå¼å¤„ç†å†…å­˜æµ‹è¯•å¤±è´¥"
    exit 1
}

# æ£€æŸ¥å†…å­˜ä½¿ç”¨æ˜¯å¦<256MB
max_memory=$(./bin/streaming_memory_test "$test_file" --report-memory)
if [ "$max_memory" -gt 268435456 ]; then
    echo "âŒ æµå¼å¤„ç†å†…å­˜ä½¿ç”¨è¶…è¿‡256MB: ${max_memory}å­—èŠ‚"
    exit 1
fi

echo "âœ… æµå¼å¤„ç†æ€§èƒ½éªŒè¯é€šè¿‡"
```

## ğŸ“‹ 5. å®Œæ•´é‡æ„æ£€æŸ¥æ¸…å•

### 5.1 **ğŸ”´ Critical: å¿…é¡»å®Œæˆçš„ä¿®æ­£**

#### **A. åŸºç¡€è®¾æ–½ç»Ÿä¸€ (é˜»å¡æ€§)**
- [ ] åˆ é™¤`data_access::cache::ReaderCache`ç±»å’Œæ‰€æœ‰ç›¸å…³å®ç°
- [ ] åˆ é™¤`data_access::cache::DataChunkCache`ç±»å’Œæ‰€æœ‰ç›¸å…³å®ç°
- [ ] åˆ é™¤å·¥å‚å‡½æ•°ä¸­çš„`threadPool`å‚æ•°ï¼Œä½¿ç”¨`UnifiedThreadPoolManager`
- [ ] åˆ é™¤å·¥å‚å‡½æ•°ä¸­çš„`readerCache`ã€`dataChunkCache`å‚æ•°
- [ ] ç§»é™¤`NetCDFPerformanceManager`ï¼Œç»Ÿä¸€ä½¿ç”¨`UnifiedPerformanceMonitor`
- [ ] æ‰€æœ‰å†…å­˜åˆ†é…ä½¿ç”¨`UnifiedMemoryManager`

#### **B. æ—¶é—´æå–å™¨å®ç° (é˜»å¡æ€§)**
- [ ] **å®ç°**`NetCDFTimeExtractor`ç±»ï¼Œæ”¯æŒCFæ—¶é—´æ ‡å‡†
- [ ] **å®ç°**`GDALTimeExtractor`ç±»ï¼Œæ”¯æŒå¤šç§æ—¶é—´æå–ç­–ç•¥
- [ ] **å®ç°**`HDF5TimeExtractor`ç±»ï¼Œæ”¯æŒHDF5æ—¶é—´æ ¼å¼
- [ ] **å®ç°**`TimeExtractorRegistry`ç±»ï¼Œæ³¨å†Œåˆ°Commonå·¥å‚
- [ ] **éªŒè¯**æ—¶é—´æå–å™¨åœ¨Commonå·¥å‚ä¸­æ­£ç¡®æ³¨å†Œ
- [ ] **æµ‹è¯•**æµå¼æ—¶é—´ç‚¹æå–åŠŸèƒ½

#### **C. æµå¼å¤„ç†å®ç° (é˜»å¡æ€§)**
- [ ] **å®ç°**`IStreamingDataAccess`æ¥å£
- [ ] **å®ç°**`StreamingNetCDFReader`ç±»ï¼Œæ”¯æŒå¤§æ–‡ä»¶æµå¼è¯»å–
- [ ] **å®ç°**`StreamingGDALReader`ç±»ï¼Œæ”¯æŒæ …æ ¼æ•°æ®æµå¼è¯»å–
- [ ] **é›†æˆ**Commonæµå¼æ¡†æ¶çš„å†…å­˜å‹åŠ›ç›‘æ§
- [ ] **éªŒè¯**2GBæ–‡ä»¶æµå¼å¤„ç†å†…å­˜<256MB

### 5.2 **ğŸŸ¡ Important: åŠŸèƒ½å¢å¼º**

#### **å¼‚æ­¥æ¡†æ¶å¼ºåŒ–**
- [ ] æ‰€æœ‰æ¥å£å¼ºåˆ¶ä½¿ç”¨`OSCEAN_FUTURE(T)`å®
- [ ] å®ç°ç»Ÿä¸€é”™è¯¯å¤„ç†æœºåˆ¶
- [ ] é›†æˆCommonå¼‚æ­¥ç»„åˆå·¥å…·
- [ ] æ·»åŠ è¶…æ—¶ä¿æŠ¤æœºåˆ¶

#### **æ€§èƒ½ä¼˜åŒ–**
- [ ] å®ç°è‡ªé€‚åº”å—å¤§å°è°ƒæ•´
- [ ] é›†æˆå†…å­˜å‹åŠ›æ„ŸçŸ¥æœºåˆ¶
- [ ] ä¼˜åŒ–å¹¶å‘è¯»å–ç­–ç•¥
- [ ] æ·»åŠ ç¼“å­˜é¢„çƒ­åŠŸèƒ½

### 5.3 **âœ… Validation: éªŒè¯ä¸æµ‹è¯•**

#### **åŠŸèƒ½éªŒè¯**
- [ ] åŸºç¡€è®¾æ–½ç»Ÿä¸€éªŒè¯è„šæœ¬é€šè¿‡
- [ ] æ—¶é—´æå–å™¨åŠŸèƒ½éªŒè¯è„šæœ¬é€šè¿‡
- [ ] æµå¼å¤„ç†æ€§èƒ½éªŒè¯è„šæœ¬é€šè¿‡
- [ ] å¤§æ–‡ä»¶å¤„ç†èƒ½åŠ›éªŒè¯ (2GB+ æ–‡ä»¶)
- [ ] å¹¶å‘è®¿é—®å®‰å…¨æ€§éªŒè¯

#### **æ¶æ„éªŒè¯**
- [ ] ä¾èµ–å…³ç³»æ£€æŸ¥è„šæœ¬é€šè¿‡
- [ ] åŠŸèƒ½é‡å¤æ£€æµ‹è„šæœ¬é€šè¿‡
- [ ] æ—¶é—´æ¶æ„åä½œéªŒè¯è„šæœ¬é€šè¿‡
- [ ] å¼‚æ­¥æ¨¡å¼ä¸€è‡´æ€§éªŒè¯è„šæœ¬é€šè¿‡

#### **è´¨é‡éªŒè¯**
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡>90%
- [ ] é›†æˆæµ‹è¯•è¦†ç›–æ ¸å¿ƒæ•°æ®è®¿é—®æµç¨‹
- [ ] æ€§èƒ½æµ‹è¯•éªŒè¯æµå¼å¤„ç†åŸºå‡†
- [ ] å†…å­˜æ³„æ¼æ£€æµ‹é€šè¿‡

---

## ğŸš€ æ€»ç»“ï¼šæ•°æ®è®¿é—®æœåŠ¡é‡æ„çš„å…³é”®æˆåŠŸå› ç´ 

### **1. ä¸¥æ ¼ä¾èµ–Common** ğŸ”´
- **é›¶é‡å¤å®ç°**: ç»ä¸å…è®¸é‡å¤å®ç°ç¼“å­˜ã€çº¿ç¨‹æ± ã€æ€§èƒ½ç›‘æ§
- **å¼ºåˆ¶ç»Ÿä¸€**: å¿…é¡»ä½¿ç”¨Commonæä¾›çš„æ‰€æœ‰åŸºç¡€è®¾æ–½ç»„ä»¶

### **2. æ—¶é—´æ¶æ„èŒè´£æ˜ç¡®** âš¡
- **æ ¼å¼ä¸“ç”¨å®ç°**: è´Ÿè´£NetCDFã€GDALã€HDF5çš„æ—¶é—´è§£æå…·ä½“å®ç°
- **å·¥å‚æ³¨å†Œ**: å‘Commonæ—¶é—´å·¥å‚æ³¨å†Œæ‰€æœ‰æ—¶é—´æå–å™¨

### **3. æµå¼å¤„ç†ä¼˜å…ˆ** ğŸ—ï¸
- **å¤§æ•°æ®å‹å¥½**: æ”¯æŒGBçº§æ•°æ®æ–‡ä»¶çš„æµå¼å¤„ç†
- **å†…å­˜é«˜æ•ˆ**: å¤„ç†2GBæ–‡ä»¶å†…å­˜ä½¿ç”¨<256MB

### **4. è´¨é‡ä¿è¯** âœ…
- **å…¨é¢éªŒè¯**: åŸºç¡€è®¾æ–½ã€æ—¶é—´æå–å™¨ã€æµå¼å¤„ç†ä¸‰é‡éªŒè¯
- **æ€§èƒ½åŸºå‡†**: æ˜ç¡®çš„å†…å­˜å’Œæ€§èƒ½æŒ‡æ ‡

**æ•°æ®è®¿é—®æœåŠ¡æ˜¯æµ·æ´‹æ•°æ®è¯»å–çš„æ ¸å¿ƒï¼Œå¿…é¡»åšåˆ°ï¼šæ— é‡å¤å®ç°ã€æ—¶é—´è§£æä¸“ä¸šã€æµå¼å¤„ç†é«˜æ•ˆã€æ¶æ„ä¾èµ–æ¸…æ™°ã€‚** 