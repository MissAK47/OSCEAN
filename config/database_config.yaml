# å…ƒæ•°æ®æœåŠ¡æ•°æ®åº“é…ç½®
database:
  base_path: "D:/OSCEAN/database"
  
  # å››ç§ä¸“ç”¨æ•°æ®åº“é…ç½®
  connections:
    # æµ·æ´‹ç¯å¢ƒæ•°æ®åº“ - å­˜å‚¨u,v,æ¸©åº¦,ç›åº¦ç­‰æµ·æ´‹å˜é‡
    ocean_environment:
      file: "ocean_environment.db"
      max_connections: 10
      timeout_seconds: 30
      enable_wal: true
      cache_size: 2000
      
    # åœ°å½¢åº•è´¨æ•°æ®åº“ - å­˜å‚¨é«˜ç¨‹,æ·±åº¦ç­‰åœ°å½¢å˜é‡
    topography_bathymetry:
      file: "topography_bathymetry.db"
      max_connections: 5
      timeout_seconds: 30
      enable_wal: true
      cache_size: 1000
      
    # è¾¹ç•Œçº¿æ•°æ®åº“ - å­˜å‚¨æµ·å²¸çº¿,è¾¹ç•Œç­‰è¾¹ç•Œå˜é‡
    boundary_lines:
      file: "boundary_lines.db"
      max_connections: 5
      timeout_seconds: 30
      enable_wal: true
      cache_size: 1000
      
    # å£°çº³ä¼ æ’­æ•°æ®åº“ - å­˜å‚¨ä¼ æ„Ÿå™¨æ•°æ®ï¼Œæ”¯æŒplatform_id + sensor_id + working_mode_idè”åˆç´¢å¼•
    sonar_propagation:
      file: "sonar_propagation.db"
      max_connections: 8
      timeout_seconds: 30
      enable_wal: true
      cache_size: 1500

# ğŸ”§ å…ƒæ•°æ®æœåŠ¡é…ç½® - å®Œå…¨é…ç½®é©±åŠ¨
metadata:
  database:
    # æ•°æ®åº“åŸºç¡€è·¯å¾„
    base_path: "D:/OSCEAN/database"
    
    # ç»Ÿä¸€è¿æ¥é…ç½®
    unified_connection:
      directory: "D:/OSCEAN/database"
      file: "ocean_environment.db"

    # Schemaæ–‡ä»¶è·¯å¾„ - å…³é”®ä¿®å¤
    schema_path: "config/unified_schema.sql"
    directory: "D:/OSCEAN/database"
    filename: "ocean_environment.db"
    max_connections: 5
    timeout_seconds: 30
    enable_wal: true
    cache_size: 1000
  
  # ğŸ”§ ç»Ÿä¸€æ•°æ®åº“æ¶æ„é…ç½®
  unified_connection:
    directory: "D:/OSCEAN/database"
    file: "ocean_environment.db"
    max_connections: 20
    timeout_seconds: 30
    enable_wal: true
    cache_size: 4000
  
  # ğŸš€ æ ¸å¿ƒåˆ›æ–°ï¼šå®Œå…¨é…ç½®é©±åŠ¨çš„SQLæŸ¥è¯¢ç³»ç»Ÿ
  queries:
    # === ğŸ“ æ’å…¥æ“ä½œ ===
    insert_file_info: |
      INSERT OR REPLACE INTO file_info 
      (file_id, file_path, logical_name, file_size, last_modified, file_format, primary_category, created_at, updated_at) 
      VALUES (?, ?, ?, ?, ?, ?, ?, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
    
    insert_spatial_coverage: |
      INSERT OR REPLACE INTO spatial_coverage 
      (file_id, min_longitude, max_longitude, min_latitude, max_latitude, spatial_resolution_x, crs_wkt) 
      VALUES (?, ?, ?, ?, ?, ?, ?)
    
    insert_temporal_coverage: |
      INSERT OR REPLACE INTO temporal_coverage 
      (file_id, start_time, end_time, start_timestamp, end_timestamp, time_resolution_seconds, time_calendar) 
      VALUES (?, ?, ?, ?, ?, ?, ?)
    
    insert_variable_info: |
      INSERT INTO variable_info 
      (file_id, variable_name, standard_name, long_name, units, data_type, variable_category) 
      VALUES (?, ?, ?, ?, ?, ?, ?)
    
    insert_variable_attributes: |
      INSERT INTO variable_attributes 
      (variable_id, attribute_name, attribute_value) 
      VALUES (?, ?, ?)
    
    # === ğŸ” æŸ¥è¯¢æ“ä½œ ===
    select_file_by_path: |
      SELECT file_id FROM file_info WHERE file_path = ?
    
    select_file_info: |
      SELECT file_id, file_path, logical_name, file_format, file_size, last_modified, primary_category 
      FROM file_info WHERE file_id = ?
    
    select_spatial_coverage: |
      SELECT min_longitude, max_longitude, min_latitude, max_latitude, spatial_resolution_x, crs_wkt 
      FROM spatial_coverage WHERE file_id = ?
    
    select_temporal_coverage: |
      SELECT start_time, end_time, time_resolution_seconds, time_calendar 
      FROM temporal_coverage WHERE file_id = ?
    
    select_variables: |
      SELECT variable_name, data_type, units, long_name 
      FROM variable_info WHERE file_id = ?
    
    # === ğŸ—‘ï¸ åˆ é™¤æ“ä½œ ===
    delete_file_info: |
      DELETE FROM file_info WHERE file_id = ?
    
    delete_spatial_coverage: |
      DELETE FROM spatial_coverage WHERE file_id = ?
    
    delete_temporal_coverage: |
      DELETE FROM temporal_coverage WHERE file_id = ?
    
    delete_variables: |
      DELETE FROM variable_info WHERE file_id = ?
    
    # === ğŸ“Š ç»Ÿè®¡æŸ¥è¯¢ ===
    count_files: |
      SELECT COUNT(*) FROM file_info
    
    count_files_by_format: |
      SELECT file_format, COUNT(*) FROM file_info GROUP BY file_format
    
    select_spatial_bounds: |
      SELECT 
        MIN(min_longitude) as overall_min_lon,
        MAX(max_longitude) as overall_max_lon,
        MIN(min_latitude) as overall_min_lat,
        MAX(max_latitude) as overall_max_lat
      FROM spatial_coverage
  
  # ğŸ¯ è¡¨ç»“æ„æ˜ å°„ - æ”¯æŒåŠ¨æ€è¡¨ç»“æ„é€‚é…
  table_mappings:
    file_info:
      primary_key: "file_id"
      path_field: "file_path"
      required_fields: ["file_id", "file_path"]
    
    spatial_coverage:
      primary_key: "file_id"
      foreign_key: "file_id"
      bounds_fields: ["min_longitude", "max_longitude", "min_latitude", "max_latitude"]
    
    temporal_coverage:
      primary_key: "file_id"
      foreign_key: "file_id"
      time_fields: ["start_time", "end_time"]
    
    variable_info:
      primary_key: "variable_id"
      foreign_key: "file_id"
      name_field: "variable_name"

# æ•°æ®åº“åˆå§‹åŒ–é…ç½®
initialization:
  create_tables_if_not_exist: true
  enable_foreign_keys: true
  journal_mode: "WAL"
  synchronous: "NORMAL" 